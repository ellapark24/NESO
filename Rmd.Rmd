---
title: "Assignment 1"
author: "Ella Park, Rosie Crookes, Kieran Marguerie de Rotrou"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

```

## R Markdown

Testing

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r data setup}

data <- read_csv("20161213_uk_wind_solar_demand_temperature_SCS2.csv")

data <- data %>%
  mutate(
    # First, convert the character string to a datetime object
    Local_DateTime = dmy_hm(`Local Time`),
    # Then, use lubridate functions to extract components
    Month = month(Local_DateTime),
    WeekdayNum = wday(Local_DateTime) - 1, # wday is 1-based (1=Sun), so subtract 1 for 0-based
    Year = year(Local_DateTime)
  )

# Define the months you want to keep
desired_months <- c(11, 12, 1, 2, 3)

# Filter rows where Month is in desired_months
filtered_data <- data[data$Month %in% desired_months & data$Year != 2015, ]

filtered_data <- filtered_data %>%
  mutate(
    Date = as.Date(dmy_hm(`Local Time`))  # Extract full date
  ) %>%
  group_by(Date) %>%
  summarise(
    across(where(is.numeric), mean, na.rm = TRUE)
  ) %>%
  ungroup()


```
```{r eda, echo = FALSE}
# Wind vs demand
wind_plot <- ggplot(demand, aes(x=wind, y=demand_gross)) +
  geom_point(alpha=0.5, color=viridis(5)[4]) +
  geom_smooth(method="lm", color="red") +
  labs(title="Peak Demand vs Wind Capacity", x="Wind Capacity Factor", y="Peak Demand (MW)") +
  theme_bw()

# Solar vs demand
solar_plot <- ggplot(demand, aes(x=solar_S, y=demand_gross)) +
  geom_point(alpha=0.5, color=viridis(5)[5]) +
  geom_smooth(method="lm", color="red") +
  labs(title="Peak Demand vs Solar Capacity", x="Solar Capacity Factor", y="Peak Demand (MW)") +
  theme_bw()

# Temp vs demand- shows negative correlation
temp_plot <- ggplot(demand, aes(x=temp, y=demand_gross)) +
   geom_point(alpha=0.5, color=viridis(9)[8]) +
   geom_smooth(method="lm", color="red") +
   labs(title="Peak Demand vs Temperature", x="Temperature (°C)", y="Peak Demand (MW)") +
   theme_bw()

# TE vs demand- shows negative correlation
te_plot <- ggplot(demand, aes(x=TE, y=demand_gross)) +
   geom_point(alpha=0.5, color=viridis(9)[4]) +
   geom_smooth(method="lm", color="red") +
   labs(title="Peak Demand vs TE", x="Temperature (°C)", y="Peak Demand (MW)") +
   theme_bw()

# Start_Year vs demand- shows negative correlation
year_plot <- ggplot(demand, aes(x=start_year, y=demand_gross)) +
   geom_point(alpha=0.5, color=viridis(5)[1]) +
   geom_smooth(method="lm", color="red") +
   labs(title="Peak Demand vs Winter Start Year", x="Year", y="Peak Demand (MW)") +
   theme_bw()
```